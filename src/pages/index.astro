---
import BaseLayout from '../layouts/BaseLayout.astro';
import CategoryItem from '../components/CategoryItem.astro';
import ProductList from '../components/ProductList.astro';

import { supabase } from '../supabase';

const { data, error } = await supabase
  .from('categories')
  .select();

// const { data, error } = await supabase
//   .from('things')
//   .select();

// const { data, error } = await supabase
//   .from('tags')
//   .select('tag');

  // .eq("uuid", "3119e8b4-c628-4694-87be-ca5b291045d3")
  // .single();

if (error) {
  console.error(error)
}

// const uniqueTags = [...new Set(data.map((t) => t.tags).flat())];

import {fetchSquareCatalog, fetchSquareCatalogTest} from '../scripts/square.ts';
import test_catalog from '../assets/sample_catalog.json';

const catalog = await fetchSquareCatalog();
// const catalog = await fetchSquareCatalogTest(test_catalog);
// console.log("catalog = ", catalog);

console.log("item = ", catalog.items[0]);

---

<BaseLayout>

  <ProductList catalog={catalog}/>

  <!-- <div>
    <div>
      <h2 class="font-bold text-center">Artists</h2>
      <div class="category-grid grid gap-2.5 lg:grid-cols-3">
        {data.filter((item) => item.is_artist).map((item) => (
          <CategoryItem item={item}/>
          ))}
    </div>
  </div> -->
    
  <!-- <h2>Categories</h2> -->
  <!-- <div>
    <div class="category-grid grid gap-2.5 lg:grid-cols-3">
      {data.filter((item) => !item.is_artist).map((item) => (
        <CategoryItem item={item}/>
        ))}
    </div>
  </div> -->

  <!-- </div> -->

</BaseLayout>
